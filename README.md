# Instant Runoff Voting Script

This Python script `vote.py` performs an Instant Runoff Voting based on a `ballots.csv` file. The script generates a Sankey diagram to visualize the voting flow and can save the diagram to an HTML file.

## Detailed Breakdown

- **main function**: The entry point of the script. It takes command-line arguments as input, generates ballots from the input CSV file, determines the winner, and generates a Sankey diagram of the voting flow.

- **generate_ballots_csv function**: Reads the input CSV file and returns a list of ballots.

- **get_winner function**: Takes the list of ballots and candidate names as input, performs the Instant Runoff Voting algorithm, and returns the voting transfer log and the winner.

- **generate_sankey function**: Takes the voting transfer log generated by `redistribute_votes` and candidate names as input, generates a Sankey diagram using Plotly, and saves it to an HTML file or optionally displays it in a new webpage, depending on the command-line arguments.


## Usage

```bash
python vote.py <input> --output sankey_diagram.html --show
```

* The <b>required</b>  `input` positional argument specifies the input CSV file (default is `ballots.csv` if not specified)

* `--ouput` specifies the output HTML file (default is `sankey_diagram.html`)

* `--show` determines whether to display the Sankey diagram in a new webpage.

## Input Format For CSV Ballot

The input `csv` file has the format exported from [https://docs.google.com/forms/u/0/d/e/1FAIpQLSeGvXF9nK_gwx1Vrr0Lq3iO9RzpyFADxYhxzx8X8EGn-DtrWg/alreadyresponded?usp=sf_link]

The input `csv` file contains the voting data for a design ranking survey. Each row represents a single response to the survey, and each column represents a question or data field in the survey.

The first row of the file is the header row, which contains the following columns:

- `Timestamp`: The date and time when the response was submitted, in the format `MM/DD/YYYY HH:MM:SS`.

- `Rank the designs below from most favorite (1st) to least favorite [Design #X]`: There is one such column per candidate, one for each design being ranked (where `X` is the design number from 1 to the number of candidates). The response in each of these columns is the respondent's ranking of that design, from "1st" (most favorite) to ${Num\_Candidate}^{th}$ (least favorite). If a design was not ranked by the respondent, the corresponding cell is left empty.


Each subsequent row in the file represents a single response/ballot to the survey, with the respondent's answers in the corresponding columns.

For instance, 
```
10/30/2023 18:46:45,2nd,3rd,4th,5th,1st,6th,8th,7th
```
means that 
at `10/30/2023 18:46:45`, the voter ranked design #1 as his/her 2nd choice, design #2 as the 3rd choice, design #4 the 4th choice, design #5 the 5th choice, design #6 the 1st choice, design #7 the 6th choice, design #8 the 8th choice, and design #9 the 7th choice.

When a design is not ranked by the voter, the corresponding cell is left empty.

When a rank is skipped, e.g. when a voter only has ranked 1st choice, 3rd choice, not the second choice, the rank of "3rd" is essentially the 2nd choice, and the rank of "1st" is the 1st choice.

## Output Format

The script prints out a list of all ballots and their ranked choices for each candidate.

The script then prints out all the rounds of voting and number of votes received by each candidate before elimination. The candidate with the least number of votes is eliminated in each round, and the votes for the eliminated candidate are redistributed to the next ranked candidate on each ballot.


The script generated a Sankey diagram of the voting flow, and saves it to an HTML file or optionally displays it in a new webpage, depending on the command-line arguments.